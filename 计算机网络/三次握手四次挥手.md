# Tcp连接

标志位：SYN ACK FIN

* 为什么需要3次🤝？
  * 保证双方可以“收”和“发”
* 为什么需要4次👋？
  * FIN和ACK，断开连接的指令来自上层

三次握手

防止服务器端因接收了早已失效的连接请求报文，从而一直等待客户端请求，最终导致形成死锁、浪费资源

（可以解释下如果两次会有什么结果？客户端发送的SYN堵塞在路上之后才到达服务器，客户端已放弃这个SYN，服务器响应ACK，等待客户端的数据，但是客户端不会大松数据，这造成资源浪费）

四次挥手

* TCP 是全双工的，双方都可以可送和接收信息
* 断开连接是双方都无法接收/发送信息给对方
* 一方发送“断开连接”的FIN之后，表示不再发送，收到ACK之后，表示对方不再接收
* 为什么客户端关闭连接前要等待2MSL时间？
  * 为了保证客户端发送的最后1个连接释放确认报文 能到达服务器，从而使得服务器能正常释放连接
  * 防止上文提到的早已失效的连接请求报文 出现在本连接中

![连接过程](https://pic3.zhimg.com/80/v2-e8aaab48ff996e5cd8a5b39dc450bd6a_hd.jpg)
