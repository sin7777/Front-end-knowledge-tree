# CDN 加速

[阿里云云栖社区](https://www.zhihu.com/question/36514327/answer/193768864)

最简单的CDN网络由一个 DNS 服务器和几台缓存服务器组成：

* 当用户点击网站页面上的内容 URL，经过本地 DNS 系统解析，DNS系统会最终将域名的解析权交给 CNAME 指向的 CDN 专用 DNS 服务器。
* CDN 的 DNS 服务器将 **CDN 的全局负载均衡设备** IP 地址返回用户。
* 用户向 CDN 的全局负载均衡设备发起内容 URL 访问请求。
* CDN 全局负载均衡设备根据用户 IP 地址，以及用户请求的内容 URL，选择一台用户所属区域的区域负载均衡设备，告诉用户向这台设备发起请求。
* 区域负载均衡设备会为用户选择一台合适的**缓存服务器**提供服务，选择的依据包括：
  * 根据用户 IP 地址，判断哪一台服务器距用户最近；
  * 根据用户所请求的 URL 中携带的内容名称，判断哪一台服务器上有用户所需内容；
  * 查询各个服务器当前的负载情况，判断哪一台服务器尚有服务能力。
  * 基于以上这些条件的综合分析之后，区域负载均衡设备会向全局负载均衡设备返回一台缓存服务器的 IP 地址。
* 全局负载均衡设备把服务器的 IP 地址返回给用户。
* 用户向缓存服务器发起请求，缓存服务器响应用户请求，将用户所需内容传送到用户终端。如果这台缓存服务器上并没有用户想要的内容，而区域均衡设备依然将它分配给了用户，那么这台服务器就要**向它的上一级缓存服务器请求内容**，直至追溯到网站的源服务器将内容拉到本地。

## CDN适用哪些场景

* 网站站点/应用加速
* 视音频点播/大文件下载分发加速
* 视频直播加速
* 移动应用加速

## 名词解析

1. **Origin Server源站**做 CDN 之前的客户真正的服务器。
2. **User访问者**，也就是要访问网站的网民。
3. **Last Mile**最后一公里，也就是网民到他所访问到的 CDN 服务器之间的路径。
4. **域名**域名是Internet网络上的一个服务器或一个网络系统的名字，全世界，没有重复的域名。
5. **CNAME记录**它是一个别名记录( Canonical Name )；当 DNS 系统在查询 CNAME 左面的名称的时候，都会转向 CNAME 右面的名称再进行查询，一直追踪到最后的 PTR 或 A 名称，成功查询后才会做出回应，否则失败。
6. **CNAME域名**CDN的域名加速需要用到CNAME记录，在阿里云控制台配置完成CDN加速后，您会得到一个加速后的域名，称之为CNAME域名（该域名一定是`*.*http://kunlun.com）`, 用户需要将自己的域名作CNAME指向这个`*.*http://kunlun.com`的域名后，域名解析的工作就正式转向阿里云，该域名所有的请求都将转向阿里云CDN的节点。
7. **DNS**DNS即Domain Name System，是域名解析服务的意思。它在互联网的作用是：把域名转换成为网络可以识别的ip地址。人们习惯记忆域名，但机器间互相只认IP地址，域名与IP地址之间是一一对应的，它们之间的转换工作称为域名解析，域名解析需要由专门的域名解析服务器来完成，整个过程是自动进行的。比如：上网时输入的百度一下，你就知道会自动转换成为`220.181.112.143`
8. **边缘节点**也称CDN节点. Cache节点等；是相对于网络的复杂结构而提出的一个概念，指距离最终用户接入具有较少的中间环节的网络节点，对最终接入用户有较好的响应能力和连接速度。其作用是将访问量较大的网页内容和对象保存在服务器前端的专用cache设备上，以此来提高网站访问的速度和质量。
9. **cache**cache高速缓冲存储器一种特殊的存储器子系统，其中复制了频繁使用的数据以利于快速访问。存储器的高速缓冲存储器存储了频繁访问的RAM位置的内容及这些数据项的存储地址。当处理器引用存储器中的某地址时，高速缓冲存储器便检查是否存有该地址。如果存有该地址，则将数据返回处理器;如果没有保存该地址，则进行常规的存储器访问。因为高速缓冲存储器总是比主RAM存储器速度快，所以当RAM的访问速度低于微处理器的速度时，常使用高速缓冲存储器。
